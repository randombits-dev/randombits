<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale = 1.0"><title>Advanced Guide to Module Federation</title><link rel="icon" type="image/svg" href="/favicon.svg"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><style type="text/css">@font-face {font-family: 'Plus Jakarta Sans';font-style: normal;font-weight: 400;font-display: swap;src: url(https://fonts.gstatic.com/s/plusjakartasans/v8/LDIbaomQNQcsA88c7O9yZ4KMCoOg4IA6-91aHEjcWuA_qU7NSQ.woff) format('woff');}@font-face {font-family: 'Righteous';font-style: normal;font-weight: 400;font-display: swap;src: url(https://fonts.gstatic.com/s/righteous/v17/1cXxaUPXBpj2rGoU7C9mjA.woff) format('woff');} /* cyrillic-ext */@font-face {font-family: 'Plus Jakarta Sans';font-style: normal;font-weight: 400;font-display: swap;src: url(https://fonts.gstatic.com/s/plusjakartasans/v8/LDIbaomQNQcsA88c7O9yZ4KMCoOg4IA6-91aHEjcWuA_qU79QB_VIKg.woff2) format('woff2');unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;}/* vietnamese */@font-face {font-family: 'Plus Jakarta Sans';font-style: normal;font-weight: 400;font-display: swap;src: url(https://fonts.gstatic.com/s/plusjakartasans/v8/LDIbaomQNQcsA88c7O9yZ4KMCoOg4IA6-91aHEjcWuA_qU79Qh_VIKg.woff2) format('woff2');unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;}/* latin-ext */@font-face {font-family: 'Plus Jakarta Sans';font-style: normal;font-weight: 400;font-display: swap;src: url(https://fonts.gstatic.com/s/plusjakartasans/v8/LDIbaomQNQcsA88c7O9yZ4KMCoOg4IA6-91aHEjcWuA_qU79Qx_VIKg.woff2) format('woff2');unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}/* latin */@font-face {font-family: 'Plus Jakarta Sans';font-style: normal;font-weight: 400;font-display: swap;src: url(https://fonts.gstatic.com/s/plusjakartasans/v8/LDIbaomQNQcsA88c7O9yZ4KMCoOg4IA6-91aHEjcWuA_qU79TR_V.woff2) format('woff2');unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}/* latin-ext */@font-face {font-family: 'Righteous';font-style: normal;font-weight: 400;font-display: swap;src: url(https://fonts.gstatic.com/s/righteous/v17/1cXxaUPXBpj2rGoU7C9WhnGFucE.woff2) format('woff2');unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;}/* latin */@font-face {font-family: 'Righteous';font-style: normal;font-weight: 400;font-display: swap;src: url(https://fonts.gstatic.com/s/righteous/v17/1cXxaUPXBpj2rGoU7C9WiHGF.woff2) format('woff2');unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;}</style><meta property="og:description" name="description" content="Beyond the basics of module federation to cover what a production app will most likely need. Dynamic Imports, Sharing Files and Libraries, Web Components, Routers, Prefetching, Cache Busting, Dynamic URLS."><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@RandomBitsDev"><meta name="twitter:title" property="og:title" content="Advanced Guide to Module Federation"><meta name="twitter:image" property="og:image" content="https://randombits.dev/_astro/mf1.dxwAVIZx.png"><meta property="og:url" content="https://randombits.dev/articles/module-federation-advanced"><link rel="canonical" href="https://randombits.dev/articles/module-federation-advanced"><script>
  const initialTheme = localStorage.getItem("theme") || 'base';
  if (initialTheme.startsWith('dark-')) {
    document.documentElement.classList.add(`theme-${initialTheme}`, `theme-dark`);
  } else {
    document.documentElement.classList.add(`theme-${initialTheme}`);
  }
</script><link rel="stylesheet" href="/_astro/index.S0J7zh_e.css" />
<link rel="stylesheet" href="/_astro/_slug_.TpGJ4NQJ.css" />
<link rel="stylesheet" href="/_astro/_slug_.iTB5GJ_8.css" /><script type="module">document.getElementById("footer__envelope").addEventListener("click",t=>{const e=["matt","randombits","dev"];navigator.clipboard.writeText(`${e[0]}@${e[1]}.${e[2]}`),document.getElementById("footer__quick-msg").style.display="inline",setTimeout(()=>{document.getElementById("footer__quick-msg").style.display="none"},1500)});
</script></head> <body class=""> <div class="flex flex-col min-h-screen"> <header class="mt-[-20px] text-center relative z-10"> <nav aria-label="Main" style="font-family: Righteous;" class="rb-color-header text-xl sm:text-2xl pt-5 rounded-b-xl overflow-hidden shadow-2xl sm:inline-flex items-center"> <a class="px-6 block sm:inline" href="/" aria-label="Home Page"> <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 -20 150 144" version="1.1" data-astro-cid-tvrurpns> <g data-astro-cid-tvrurpns> <path id="text" fill="none" d="M25 55 A1 1, 0 0 1 125 55 A1 1, 0 0 1 25 55" data-astro-cid-tvrurpns></path> <path id="line" fill="none" stroke-width="5" d="M35 55 A1 1, 0 0 1 115 55 A1 1, 0 0 1 35 55" data-astro-cid-tvrurpns></path> <text font-size="30" letter-spacing="4.6px" data-astro-cid-tvrurpns> <textPath href="#text" data-astro-cid-tvrurpns>
011100100110001000000
</textPath> </text> <text x="50" y="72" font-size="50" data-astro-cid-tvrurpns>rb</text> </g> </svg>  </a> <a href="/articles" class="header-link">articles</a> /
<a href="/tools" class="header-link">projects</a> /
<a href="/about" class="header-link">about</a> </nav> </header> <main class="flex-1">  <div class="my-20 mx-5 md:mx-10">  <div class="rb-article"> <aside class="rb-article__sidebar"></aside> <section> <div class="card overflow-hidden"> <div class="card-contents" data-astro-cid-4wvhzws4> <div class="text-center" data-astro-cid-4wvhzws4>  <h1 data-astro-cid-4wvhzws4>Advanced Guide to Module Federation</h1> <p class="italic mx-10 md:mx-30" data-astro-cid-4wvhzws4>Beyond the basics of module federation to cover what a production app will most likely need. Dynamic Imports, Sharing Files and Libraries, Web Components, Routers, Prefetching, Cache Busting, Dynamic URLS.</p> <div class="text-2xl italic" data-astro-cid-4wvhzws4>January 1, 2023</div> </div> </div> <hr data-astro-cid-4wvhzws4>  <article class="article-body"> <p>There are plenty of articles about setting up Webpack’s Module Federation.
But almost all the articles focus on the basics.
Here I will go over steps you want to consider in a production app.</p>
<h2 id="dynamic-imports">Dynamic Imports</h2>
<p>Most examples show using the <em>remotes</em> array to specify remote apps:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token literal-property property">remotes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">app1</span><span class="token operator">:</span> <span class="token string">'app1@http://localhost:3001/remoteEntry.js'</span>
<span class="token punctuation">}</span></code></pre>
<p>This simply tells webpack to fetch <em>app1</em> at given address when the container app loads.</p>
<p>There are a few limitations in this approach:</p>
<p><strong>The <em>remoteEntry.js</em> files get fetched immediately when your container app loads.</strong>
This is not ideal if you have a large list of remotes, or you have remotes that will never load for the user.</p>
<p><strong>The browser may cache the file.</strong>
Since there is not a version or timestamp in the URL, the browser can cache the file, and users will not receive new
deployments immediately.</p>
<p><strong>Your options for dynamically setting the URL is more limited.</strong>
You may want to change remote urls without needing a redeployment. This could be how you roll out production updates.
Or maybe you need to change the url of the remote depending on the region the user is in.</p>
<h2 id="dynamic-imports-script">Dynamic Imports Script</h2>
<p>To implement dynamic imports, you will want to create a utility script like the following:</p>
<pre class="language-typescript"><code is:raw="" class="language-typescript"><span class="token keyword">declare</span> global <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">__webpack_init_sharing__</span><span class="token operator">:</span> <span class="token punctuation">(</span>parameter<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> __webpack_share_scopes__<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> __webpack_require__<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token function-variable function">l</span><span class="token operator">:</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token function-variable function">cb</span><span class="token operator">:</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">loadRemote</span> <span class="token operator">=</span> <span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> scope<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span>
    <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> timestamp <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">?t=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
        __webpack_require__<span class="token punctuation">.</span><span class="token function">l</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>timestamp<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token operator">?.</span>type <span class="token operator">===</span> <span class="token string">'load'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Loading script failed: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>event<span class="token operator">?.</span>target<span class="token operator">?.</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            scope<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">initSharing</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>__webpack_share_scopes__<span class="token operator">?.</span>default<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> <span class="token function">__webpack_init_sharing__</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">initContainer</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>containerScope<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>containerScope<span class="token punctuation">.</span>__initialized <span class="token operator">&#x26;&#x26;</span> <span class="token operator">!</span>containerScope<span class="token punctuation">.</span>__initializing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        containerScope<span class="token punctuation">.</span>__initializing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">await</span> containerScope<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>__webpack_share_scopes__<span class="token punctuation">.</span>default<span class="token punctuation">)</span><span class="token punctuation">;</span>
        containerScope<span class="token punctuation">.</span>__initialized <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">delete</span> containerScope<span class="token punctuation">.</span>__initializing<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> importRemote <span class="token operator">=</span> <span class="token generic-function"><span class="token function">async</span> <span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> scope<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> module<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&#x3C;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">[</span>scope<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Load the remote and initialize the share scope if it's empty</span>
        <span class="token keyword">await</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">loadRemote</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> scope<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">initSharing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">[</span>scope<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
                <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scope<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> not found on window object</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Initialize the container to get shared modules and get the module factory:</span>
        <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> moduleFactory<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            <span class="token function">initContainer</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>scope<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            window<span class="token punctuation">[</span>scope<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">)</span> <span class="token operator">?</span> module <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">module</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">moduleFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> moduleFactory <span class="token operator">=</span> <span class="token keyword">await</span> window<span class="token punctuation">[</span>scope<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">)</span> <span class="token operator">?</span> module <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">module</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">moduleFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>You can then pull in a remote app like:</p>
<pre class="language-typescript"><code is:raw="" class="language-typescript"><span class="token function">importRemote</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3001/remoteEntry.js'</span><span class="token punctuation">,</span> <span class="token string">'app1'</span><span class="token punctuation">,</span> <span class="token string">'bootstrap'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">setArticles</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>For reference, here would be the webpack config for the remote app:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"app1"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">"remoteEntry.js"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">exposes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'./bootstrap'</span><span class="token operator">:</span> <span class="token string">'./src/bootstrap'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>If you store your remote urls in environment variables or another method of configuration, you can then make a helper
function:</p>
<pre class="language-typescript"><code is:raw="" class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">const</span> importRemoteByName <span class="token operator">=</span> <span class="token punctuation">(</span>remoteName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> module <span class="token operator">=</span> <span class="token string">'bootstrap'</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token constant">REMOTE_URLS</span><span class="token punctuation">[</span>remoteName<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'/remoteEntry.js'</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">importRemote</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> remoteName<span class="token punctuation">,</span> module<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<blockquote>
<p>When using dynamic imports, you don’t even have to use the ModuleFederationPlugin in your top level app.
Although you still may want to if you are sharing dependencies.</p>
</blockquote>
<h2 id="shared-libraries">Shared Libraries</h2>
<p>Sharing dependencies between apps is easy. Simply load the dependencies from package.json, and then pass the list to
module federation:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token keyword">const</span> ModuleFederationPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"webpack/lib/container/ModuleFederationPlugin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> deps <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"./package.json"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dependencies<span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"app1"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">"remoteEntry.js"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token operator">...</span>deps
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre>
<p>Any libraries that need to be <strong>singletons</strong> (can only be initialized once), can be declared as such.
This is overriding the <strong>react</strong> dependency from package.json:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"app1"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">"remoteEntry.js"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>deps<span class="token punctuation">,</span>
        <span class="token string-property property">'react'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">singleton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">requiredVersion</span><span class="token operator">:</span> deps<span class="token punctuation">.</span>react
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>Most notably, <strong>react</strong> and <strong>preact</strong> have to be singletons to work properly.
Also, if preact hooks are used, it also needs to be declared separately, even though they come from the same dependency:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"app1"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">"remoteEntry.js"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">shared</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>deps<span class="token punctuation">,</span>
        <span class="token string-property property">'preact'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">singleton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">requiredVersion</span><span class="token operator">:</span> deps<span class="token punctuation">.</span>preact
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string-property property">'preact/hooks'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">singleton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token literal-property property">requiredVersion</span><span class="token operator">:</span> deps<span class="token punctuation">.</span>preact
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<h2 id="sharing-static-files">Sharing Static Files</h2>
<p>You can expose static files like JSON to share with other apps.</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"app1"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">"remoteEntry.js"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">exposes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'./bootstrap'</span><span class="token operator">:</span> <span class="token string">'./src/bootstrap'</span><span class="token punctuation">,</span>
        <span class="token string-property property">'./metadata'</span><span class="token operator">:</span> <span class="token string">'./src/metadata.json'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>To use, simply change the module name:</p>
<pre class="language-typescript"><code is:raw="" class="language-typescript"><span class="token function">importRemote</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3001/remoteEntry.js'</span><span class="token punctuation">,</span> <span class="token string">'app1'</span><span class="token punctuation">,</span> <span class="token string">'metadata'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>metadata<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Don’t worry, remoteEntry.js will <strong>NOT</strong> be fetched every time you call importRemote, it is automatically cached via our
script above.</p>
<h2 id="use-web-components">Use Web Components</h2>
<p>I found that the simplest way to use module federation is to have my remote applications expose web components.</p>
<p>For example, here is my <strong>bootstrap.tsx</strong> file for a remote:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'app1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">App1</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token literal-property property">reactRoot</span><span class="token operator">:</span> Root <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>reactRoot <span class="token operator">=</span> <span class="token function">createRoot</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>reactRoot<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&#x3C;</span>App<span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">disconnectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>reactRoot<span class="token punctuation">.</span><span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>reactRoot <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'app1'</span><span class="token punctuation">,</span> App1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>This is how my container application loads the remote:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">RemoteApp1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">importRemote</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3001/remoteEntry.js'</span><span class="token punctuation">,</span> <span class="token string">'app1'</span><span class="token punctuation">,</span> <span class="token string">'bootstrap'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&#x3C;</span>app1<span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>That’s it!. Because your using web components, you don’t need to wait for the remote import to resolve.
You can simply render <code>&#x3C;app1/></code>, which will be an empty element until the remote app is loaded, and the web component
populates.</p>
<p>Web components also makes it easier to create a generic component that will load remote applications:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">RemoteApp</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>appName<span class="token punctuation">,</span> params<span class="token punctuation">}</span><span class="token operator">:</span> Params</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">importRemoteByName</span><span class="token punctuation">(</span>appName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
            <span class="token comment">// handle error if needed</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> CustomElement <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">remote-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>appName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&#x3C;</span>CustomElement <span class="token punctuation">{</span><span class="token operator">...</span>params<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<h2 id="custom-router-that-resolves-remote-routes">Custom router that resolves remote routes</h2>
<p>If you have routes that display a remote application, you will notice that the page is blank for a second before the
application populates.
This is because the route transitions immediately, and the remote application is loaded afterwards.
A better experience would be to load the remote before transitioning to the new route.
And to accomplish this you need to implement a custom router. Don’t worry, it’s easy.</p>
<p>Say we want the following routes:</p>
<pre class="language-typescript"><code is:raw="" class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ROUTES</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
        element<span class="token operator">:</span> <span class="token operator">&#x3C;</span>HomePage<span class="token operator">/</span><span class="token operator">></span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        path<span class="token operator">:</span> <span class="token string">'/app1'</span><span class="token punctuation">,</span>
        remote<span class="token operator">:</span> <span class="token string">'app1'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<p>We can either define an element to render, or a remote application to render.
We can also define both an element and a remote, if we have the scenario where we are rendering a local element that
contains a remote application.
Then we can still preload the remote, and improve the performance.</p>
<p>Here is the router, which defines a context:</p>
<pre class="language-typescript"><code is:raw="" class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IRoute</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    element<span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">JSX</span><span class="token punctuation">.</span>Element<span class="token punctuation">;</span>
    remote<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    params<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">IRouterContext</span> <span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    routes<span class="token operator">:</span> <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> element<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function-variable function">navigate</span><span class="token operator">:</span> <span class="token punctuation">(</span>newUrl<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
    current<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    params<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">GLOBAL_ROUTE_CONTEXT</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    url<span class="token operator">:</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">,</span>
    routes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    navigate<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    current<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    params<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> RouterContext <span class="token operator">=</span> <span class="token generic-function"><span class="token function">createContext</span><span class="token generic class-name"><span class="token operator">&#x3C;</span>IRouterContext<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token constant">GLOBAL_ROUTE_CONTEXT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">useRouter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">useContext</span><span class="token punctuation">(</span>RouterContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">Router</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>routes<span class="token punctuation">,</span> children<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>url<span class="token punctuation">,</span> setUrl<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token punctuation">[</span>current<span class="token punctuation">,</span> setCurrent<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&#x3C;</span>IRoute<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>params<span class="token punctuation">,</span> setParams<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&#x3C;</span><span class="token builtin">any</span><span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">calcRoute</span> <span class="token operator">=</span> <span class="token punctuation">(</span>newUrl<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">setUrl</span><span class="token punctuation">(</span>newUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> newParams<span class="token punctuation">;</span>
        <span class="token keyword">const</span> newCurrent <span class="token operator">=</span> routes<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>child <span class="token operator">=></span> <span class="token punctuation">{</span>
            newParams <span class="token operator">=</span> <span class="token function">routeTest</span><span class="token punctuation">(</span>newUrl<span class="token punctuation">,</span> child<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span>newParams<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">!==</span> newCurrent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>newCurrent<span class="token punctuation">.</span>remote<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">importRemote</span><span class="token punctuation">(</span>newCurrent<span class="token punctuation">.</span>remote<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
                    <span class="token function">setCurrent</span><span class="token punctuation">(</span>newCurrent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">setParams</span><span class="token punctuation">(</span>newParams<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">setCurrent</span><span class="token punctuation">(</span>newCurrent<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">setParams</span><span class="token punctuation">(</span>newParams<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">navigate</span> <span class="token operator">=</span> <span class="token punctuation">(</span>newUrl<span class="token punctuation">,</span> skipHistory <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>skipHistory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> newUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">calcRoute</span><span class="token punctuation">(</span>newUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">onPopState</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">navigate</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> onPopState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
            window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> onPopState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token function">calcRoute</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>RouterContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>url<span class="token punctuation">,</span> routes<span class="token punctuation">,</span> current<span class="token punctuation">,</span> params<span class="token punctuation">,</span> navigate<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>RouterContext<span class="token punctuation">.</span>Provider<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Here is the router outlet component:</p>
<pre class="language-typescript"><code is:raw="" class="language-typescript"><span class="token keyword">const</span> <span class="token function-variable function">getElementToRender</span> <span class="token operator">=</span> <span class="token punctuation">(</span>current<span class="token operator">:</span> IRoute<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>current<span class="token punctuation">.</span>element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> current<span class="token punctuation">.</span>element<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>current<span class="token punctuation">.</span>remote<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token operator">&#x3C;</span>RemoteApp key<span class="token operator">=</span><span class="token punctuation">{</span>current<span class="token punctuation">.</span>path<span class="token punctuation">}</span> appName<span class="token operator">=</span><span class="token punctuation">{</span>current<span class="token punctuation">.</span>remote<span class="token punctuation">}</span> params<span class="token operator">=</span><span class="token punctuation">{</span>current<span class="token punctuation">.</span>params<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token operator">&#x3C;</span>div<span class="token operator">></span>Not found<span class="token operator">&#x3C;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">RouterOutlet</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>current<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&#x3C;</span>OutletContainer id<span class="token operator">=</span><span class="token string">"outlet"</span><span class="token operator">></span><span class="token punctuation">{</span><span class="token function">getElementToRender</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&#x3C;</span><span class="token operator">/</span>OutletContainer<span class="token operator">></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Now we can define our main <strong>App.tsx</strong> file:</p>
<pre class="language-typescript"><code is:raw="" class="language-typescript"><span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&#x3C;</span>Router routes<span class="token operator">=</span><span class="token punctuation">{</span><span class="token constant">ROUTES</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>Header<span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>RouterOutlet<span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&#x3C;</span>Footer<span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&#x3C;</span><span class="token operator">/</span>Router<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="prefetch-remotes">Prefetch remotes</h2>
<p>If using the dynamic imports script, you could start preloading apps that users are likely to need.
After the app is done loading, you can simply call <code>importRemote</code> for each app you want to preload:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token function">importRemote</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3001/remoteEntry.js'</span><span class="token punctuation">,</span> <span class="token string">'app1'</span><span class="token punctuation">,</span> <span class="token string">'bootstrap'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">importRemote</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3002/remoteEntry.js'</span><span class="token punctuation">,</span> <span class="token string">'app2'</span><span class="token punctuation">,</span> <span class="token string">'bootstrap'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2 id="caching-strategy">Caching Strategy</h2>
<p>Everytime a remote app is loaded, we want to load the latest version of the remote app, but we also want to cache as
much as we can to improve loading time.</p>
<p>The answer to this is always fetching <code>remoteEntry.js</code> fresh, and then caching everything else.
If you are using the <em>dynamic imports script</em>, the remoteEntry.js file is cache busted through a timestamp in the
request, so it is loaded fresh every time:</p>
<pre class="language-plaintext"><code is:raw="" class="language-plaintext">http://localhost:3002/remoteEntry.js?t=1682726535364</code></pre>
<p>This is fine, since remoteEntry.js is very tiny, and only points at the rest of the files to load.</p>
<p>Then, if we make sure to use content hashes for our script names when we build, and mark the files as immutable though
the <strong>Cache-Control</strong> header, the browser will cache everything besides that initial remoteEntry.js.</p>
<p>Webpack output config:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">"[contenthash].js"</span> <span class="token comment">// d0fb3aa6b14ecb0578b5.js</span>
<span class="token punctuation">}</span></code></pre>
<p>Cache-Control header:</p>
<pre class="language-plaintext"><code is:raw="" class="language-plaintext">Cache-Control: public, max-age=31536000, immutable</code></pre>
<h2 id="dynamic-urls---env-variables">Dynamic URLs - env variables</h2>
<p>I recommend setting your remote application urls in environment variables.
That way you can change the urls for different environments, and you can set them to localhost for development.</p>
<p>Create a <em>.env</em> file in your root directory:</p>
<pre class="language-yaml"><code is:raw="" class="language-yaml">REMOTE_APP1=https<span class="token punctuation">:</span>//example.github.io/remote1
REMOTE_APP2=http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>8080/remote2</code></pre>
<p>As you can see, I’m fetching remote1 from the production environment, so I don’t need to start a local server.
But I want to work on remote2, so I’m pointing it to the local version.</p>
<p>On the server, you would set these environment variables in your CI pipeline (github, vercel, etc).
And when they are set in your CI environment, they take priority over anything in your .env file.
So you can check in the local .env if you wish.</p>
<p>Here is an example of loading the environment variables in webpack:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token keyword">const</span> DefinePlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack/lib/DefinePlugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dotenv'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> remoteVars <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>
    Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>key<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> key<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'REMOTE_'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string-property property">'REMOTE_CONFIG'</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>remoteVars<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre>
<p><code>require('dotenv').config();</code> loads the environment variables from your <em>.env</em> file, and puts them into the
<em>process.env</em> object.
Then, instead of hardcoding each variable key in the script, I am grabbing all keys that start with <em>REMOTE_</em>.
And finally the <em>DefinePlugin</em> will inject the variables into your code.
In this example, I’m injecting an object called <em>REMOTE_CONFIG</em>, which would end up getting compiled as a global
variable like:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token keyword">const</span> <span class="token constant">REMOTE_CONFIG</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">'REMOTE_APP1'</span><span class="token operator">:</span> <span class="token string">'https://example.github.io/remote1'</span><span class="token punctuation">,</span>
    <span class="token string-property property">'REMOTE_APP2'</span><span class="token operator">:</span> <span class="token string">'http://localhost:8080/remote2'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>Then you can use anywhere in your code:</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token constant">REMOTE_CONFIG</span><span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">REMOTE_APP1</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// https://example.github.io/remote1</span></code></pre>
<p>If your using typescript, make sure to declare the global variable:</p>
<pre class="language-typescript"><code is:raw="" class="language-typescript"><span class="token keyword">declare</span> global <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token constant">REMOTE_CONFIG</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="closing-thoughts">Closing Thoughts</h2>
<p>Module Federation is a great pattern to use for SPA micro frontends.</p>
<p>This patten is also easy to implement for <strong>SSR</strong> (server side render) webapps, as long as the remote app is the only
app
generated on the server.
It is entirely possible to implement with all remotes coming from SSR, but it gets more complex and I wouldn’t recommend
it for that.</p>
<p>It is also not the best option for SSG webapps (static site generation).</p> </article> </div>  </section> <aside class="rb-article__sidebar"> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();;(()=>{var b=Object.defineProperty;var f=(c,o,i)=>o in c?b(c,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[o]=i;var l=(c,o,i)=>(f(c,typeof o!="symbol"?o+"":o,i),i);var p;{let c={0:t=>m(t),1:t=>i(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(i(t)),5:t=>new Set(i(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},o=t=>{let[e,r]=t;return e in c?c[e](r):void 0},i=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([e,r])=>[e,o(r)]));customElements.get("astro-island")||customElements.define("astro-island",(p=class extends HTMLElement{constructor(){super(...arguments);l(this,"Component");l(this,"hydrator");l(this,"hydrate",async()=>{var d;if(!this.hydrator||!this.isConnected)return;let e=(d=this.parentElement)==null?void 0:d.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let r=this.querySelectorAll("astro-slot"),a={},h=this.querySelectorAll("template[data-astro-template]");for(let n of h){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("data-astro-template")||"default"]=n.innerHTML,n.remove())}for(let n of r){let s=n.closest(this.tagName);s!=null&&s.isSameNode(this)&&(a[n.getAttribute("name")||"default"]=n.innerHTML)}let u;try{u=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(n){let s=this.getAttribute("component-url")||"<unknown>",y=this.getAttribute("component-export");throw y&&(s+=` (export ${y})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),n),n}await this.hydrator(this)(this.Component,u,a,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});l(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),r.disconnect(),this.childrenConnectedCallback()},r=new MutationObserver(()=>{var a;((a=this.lastChild)==null?void 0:a.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});r.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}start(){let e=JSON.parse(this.getAttribute("opts")),r=this.getAttribute("client");if(Astro[r]===void 0){window.addEventListener(`astro:${r}`,()=>this.start(),{once:!0});return}Astro[r](async()=>{let a=this.getAttribute("renderer-url"),[h,{default:u}]=await Promise.all([import(this.getAttribute("component-url")),a?import(a):()=>()=>{}]),d=this.getAttribute("component-export")||"default";if(!d.includes("."))this.Component=h[d];else{this.Component=h;for(let n of d.split("."))this.Component=this.Component[n]}return this.hydrator=u,this.hydrate},e,this)}attributeChangedCallback(){this.hydrate()}},l(p,"observedAttributes",["props"]),p))}})();</script><astro-island uid="2m3GGS" data-solid-render-id="s0" component-url="/_astro/ArticleTOC.tjH7ommV.js" component-export="default" renderer-url="/_astro/client.EJTk-FNr.js" props="{&quot;slot&quot;:[0,&quot;sidebar&quot;],&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;dynamic-imports&quot;],&quot;text&quot;:[0,&quot;Dynamic Imports&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;dynamic-imports-script&quot;],&quot;text&quot;:[0,&quot;Dynamic Imports Script&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;shared-libraries&quot;],&quot;text&quot;:[0,&quot;Shared Libraries&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;sharing-static-files&quot;],&quot;text&quot;:[0,&quot;Sharing Static Files&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;use-web-components&quot;],&quot;text&quot;:[0,&quot;Use Web Components&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;custom-router-that-resolves-remote-routes&quot;],&quot;text&quot;:[0,&quot;Custom router that resolves remote routes&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;prefetch-remotes&quot;],&quot;text&quot;:[0,&quot;Prefetch remotes&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;caching-strategy&quot;],&quot;text&quot;:[0,&quot;Caching Strategy&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;dynamic-urls---env-variables&quot;],&quot;text&quot;:[0,&quot;Dynamic URLs - env variables&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;closing-thoughts&quot;],&quot;text&quot;:[0,&quot;Closing Thoughts&quot;]}]]]}" ssr="" client="load" opts="{&quot;name&quot;:&quot;ArticleTOC&quot;,&quot;value&quot;:true}" await-children=""><nav data-hk="s00-0" aria-label="Article Sections" class="card rb-article__nav"><a data-hk="s00-1" class="text-[16px]" href="#dynamic-imports" aria-selected="false">Dynamic Imports</a><a data-hk="s00-2" class="text-[16px]" href="#dynamic-imports-script" aria-selected="false">Dynamic Imports Script</a><a data-hk="s00-3" class="text-[16px]" href="#shared-libraries" aria-selected="false">Shared Libraries</a><a data-hk="s00-4" class="text-[16px]" href="#sharing-static-files" aria-selected="false">Sharing Static Files</a><a data-hk="s00-5" class="text-[16px]" href="#use-web-components" aria-selected="false">Use Web Components</a><a data-hk="s00-6" class="text-[16px]" href="#custom-router-that-resolves-remote-routes" aria-selected="false">Custom router that resolves remote routes</a><a data-hk="s00-7" class="text-[16px]" href="#prefetch-remotes" aria-selected="false">Prefetch remotes</a><a data-hk="s00-8" class="text-[16px]" href="#caching-strategy" aria-selected="false">Caching Strategy</a><a data-hk="s00-9" class="text-[16px]" href="#dynamic-urls---env-variables" aria-selected="false">Dynamic URLs - env variables</a><a data-hk="s00-10" class="text-[16px]" href="#closing-thoughts" aria-selected="false">Closing Thoughts</a></nav><!--astro:end--></astro-island> </aside> </div>  </div>  </main> <footer> <div class="footer-content"> <nav aria-label="Social Links" class="social-links"> <a href="https://github.com/randombits-dev" target="_blank" aria-label="Github"> <div><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
  <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
</svg></div> </a> <a href="https://discord.gg/VdAySp2Y" target="_blank" aria-label="Discord"> <div><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-discord" viewBox="0 0 16 16">
  <path d="M13.545 2.907a13.227 13.227 0 0 0-3.257-1.011.05.05 0 0 0-.052.025c-.141.25-.297.577-.406.833a12.19 12.19 0 0 0-3.658 0 8.258 8.258 0 0 0-.412-.833.051.051 0 0 0-.052-.025c-1.125.194-2.22.534-3.257 1.011a.041.041 0 0 0-.021.018C.356 6.024-.213 9.047.066 12.032c.001.014.01.028.021.037a13.276 13.276 0 0 0 3.995 2.02.05.05 0 0 0 .056-.019c.308-.42.582-.863.818-1.329a.05.05 0 0 0-.01-.059.051.051 0 0 0-.018-.011 8.875 8.875 0 0 1-1.248-.595.05.05 0 0 1-.02-.066.051.051 0 0 1 .015-.019c.084-.063.168-.129.248-.195a.05.05 0 0 1 .051-.007c2.619 1.196 5.454 1.196 8.041 0a.052.052 0 0 1 .053.007c.08.066.164.132.248.195a.051.051 0 0 1-.004.085 8.254 8.254 0 0 1-1.249.594.05.05 0 0 0-.03.03.052.052 0 0 0 .003.041c.24.465.515.909.817 1.329a.05.05 0 0 0 .056.019 13.235 13.235 0 0 0 4.001-2.02.049.049 0 0 0 .021-.037c.334-3.451-.559-6.449-2.366-9.106a.034.034 0 0 0-.02-.019Zm-8.198 7.307c-.789 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.45.73 1.438 1.613 0 .888-.637 1.612-1.438 1.612Zm5.316 0c-.788 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.451.73 1.438 1.613 0 .888-.631 1.612-1.438 1.612Z"/>
</svg></div> </a> <a href="https://twitter.com/RandomBitsDev" target="_blank" aria-label="Twitter"> <div><svg viewBox="0 0 24 24">
  <g>
    <path
      d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path>
  </g>
</svg>
</div> </a> <a href="https://linktr.ee/randombits" target="_blank" aria-label="Linktree"> <div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" xml:space="preserve"><path d="M24 0C10.745 0 0 10.745 0 24s10.745 24 24 24 24-10.745 24-24S37.255 0 24 0zm1.881 37.001h-3.762v-8.495h3.762v8.495zm8.707-13.622h-6.432l4.581 4.45-2.518 2.528L24 24.107l-6.22 6.25-2.518-2.518 4.581-4.45h-6.432v-3.59h6.402l-4.551-4.339 2.518-2.579 4.339 4.46V11h3.762v6.341l4.338-4.46 2.518 2.579-4.551 4.339h6.402v3.58z"></path></svg></div> </a> <a href="https://keybase.io/randombitsdev" target="_blank" aria-label="Keybase"> <div><?xml version="1.0" encoding="utf-8"?><!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
  <path d="M13.927 28.495c0 0.703-0.567 1.271-1.271 1.271-0.697 0-1.271-0.568-1.271-1.271s0.568-1.271 1.271-1.271c0.699 0 1.265 0.573 1.265 1.271zM21.817 28.495c0 0.703-0.567 1.271-1.271 1.271-0.703 0-1.271-0.568-1.271-1.271s0.563-1.271 1.265-1.271c0.704 0 1.271 0.573 1.271 1.271zM27.869 16.287l-0.208-0.276c-0.057-0.079-0.125-0.151-0.188-0.229-0.061-0.084-0.124-0.151-0.187-0.229-0.141-0.156-0.281-0.317-0.427-0.479l-0.1-0.104-0.124-0.131-0.177-0.177c-0.021-0.025-0.043-0.047-0.068-0.073-1.547-1.515-3.339-2.645-5.271-3.337l-0.308-0.105c0.016-0.031 0.032-0.072 0.048-0.109 0.547-1.416 0.489-2.963-0.163-4.339-0.656-1.38-1.807-2.4-3.249-2.88-0.875-0.287-1.641-0.427-2.281-0.405-0.047-0.141-0.136-0.772 0.661-2.464l-1.609-0.948-0.385 0.531c-0.437 0.609-0.864 1.193-1.26 1.772-0.437-0.459-1.021-0.735-1.656-0.772l-1.881-0.115c-0.041-0.004-0.093-0.004-0.135-0.004-1.323 0-2.417 1.025-2.495 2.337l-0.12 1.871v0.005c-0.079 1.369 0.968 2.552 2.344 2.635l1.333 0.084c-0.089 1.12 0.099 2.161 0.541 3.072-1.797 0.751-3.448 1.871-4.88 3.313-4.407 4.459-4.407 9.339-4.407 13.26v2.371l1.74-1.849c0.353 1.239 0.869 2.407 1.525 3.484h2.261c-1.109-1.484-1.891-3.235-2.24-5.131l2.552-2.708-1.312 4.125 2.317-1.693c4.099-2.979 8.995-3.667 14.547-2.036 2.407 0.708 4.751 0.052 5.964-1.677l0.14-0.219c0.12 0.661 0.188 1.328 0.188 1.995 0 2.084-0.339 4.917-1.839 7.349h2.145c1.037-2.083 1.579-4.579 1.579-7.349-0.005-2.932-1.052-5.896-2.917-8.364zM11.86 8.255c0.161-1.337 0.771-2.599 1.64-3.957 0.031 0.063 0.073 0.124 0.109 0.187 0.355 0.532 0.953 0.833 1.599 0.808 0.292-0.011 0.808 0.036 1.647 0.312 0.952 0.313 1.713 0.989 2.14 1.901 0.432 0.907 0.469 1.921 0.109 2.864-0.235 0.595-0.609 1.095-1.077 1.48l-0.543-0.672-0.005-0.005c-0.369-0.453-0.921-0.713-1.509-0.713-0.448 0-0.887 0.156-1.235 0.443-0.443 0.359-0.683 0.88-0.708 1.411-1.605-0.724-2.401-2.192-2.172-4.057zM17.599 15.068l-0.692 0.568c-0.063 0.047-0.125 0.067-0.199 0.067-0.083 0-0.177-0.036-0.235-0.109l-0.145-0.181c-0.115-0.131-0.088-0.333 0.041-0.443l0.683-0.563-1.407-1.729c-0.145-0.183-0.119-0.443 0.057-0.584 0.079-0.063 0.167-0.099 0.261-0.099 0.119 0 0.239 0.052 0.317 0.151l3.953 4.865c0.145 0.177 0.12 0.437-0.057 0.577-0.052 0.043-0.109 0.073-0.167 0.084-0.032 0.011-0.063 0.016-0.093 0.016-0.12 0-0.24-0.057-0.324-0.152l-0.391-0.489-1.396 1.141c-0.057 0.047-0.129 0.072-0.203 0.072-0.088 0-0.188-0.041-0.249-0.12l-0.636-0.771c-0.109-0.135-0.088-0.339 0.047-0.448l1.401-1.145zM10.339 6.489l-1.593-0.104c-0.344-0.016-0.605-0.312-0.584-0.645l0.12-1.871c0.021-0.328 0.292-0.583 0.615-0.583h0.031l1.871 0.125c0.167 0.004 0.317 0.077 0.421 0.203 0.109 0.125 0.167 0.276 0.156 0.448l-0.011 0.131c-0.427 0.76-0.78 1.515-1.031 2.296zM27.036 21.797c-0.755 1.072-2.249 1.443-3.9 0.957-5.177-1.52-9.86-1.208-13.953 0.933l2.177-6.828-7.053 7.479c0.131-5.021 3.272-9.292 7.677-11.084 0.631 0.495 1.38 0.881 2.229 1.12 0.213 0.057 0.432 0.099 0.641 0.136-0.245 0.615-0.157 1.333 0.281 1.875l0.099 0.125c-0.229 0.599-0.141 1.296 0.296 1.828l0.631 0.776c0.355 0.432 0.88 0.688 1.437 0.688 0.432 0 0.849-0.152 1.183-0.423l0.38-0.307c0.235 0.099 0.489 0.151 0.756 0.151 0.151 0 0.296-0.016 0.443-0.047 0.285-0.068 0.561-0.204 0.796-0.391 0.828-0.677 0.959-1.912 0.276-2.745l-2.224-2.739c0.193-0.157 0.376-0.329 0.541-0.511 0.183 0.052 0.365 0.104 0.537 0.161 0.353 0.129 0.708 0.26 1.057 0.416 1.339 0.595 2.604 1.469 3.692 2.532 0.043 0.041 0.084 0.072 0.115 0.109l0.229 0.235c0.047 0.052 0.099 0.104 0.147 0.161 0.104 0.115 0.213 0.233 0.317 0.353l0.172 0.204c0.057 0.067 0.115 0.135 0.172 0.213l0.151 0.197c0.052 0.068 0.104 0.136 0.156 0.204 1.12 1.536 1.317 3.109 0.536 4.213v0.005zM10.292 5.484l-1.115-0.068 0.073-1.109 1.109 0.068z"/>
</svg></div> </a> <button id="footer__envelope" title="Copy Email"> <span><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"/></svg>
</span> <span id="footer__quick-msg" class="quick-msg">Email copied</span> </button> </nav> </div> <div class="copyright">
&copy; 2024 Random Bits
</div> </footer>  </div> <astro-island uid="Z2807xS" data-solid-render-id="s1" component-url="/_astro/ThemeChanger.BVxAopdW.js" component-export="default" renderer-url="/_astro/client.EJTk-FNr.js" props="{}" ssr="" client="load" opts="{&quot;name&quot;:&quot;ThemeChanger&quot;,&quot;value&quot;:true}" await-children=""><div data-hk="s10-0" class="fixed md:fixed w-full bottom-[-21px] text-center z-20"><div class="rb-theme-changer inline-block md:rounded-t-xl overflow-hidden bg-header text-header-text"><button data-hk="s10-1" class="rounded-none inline-block px-5 py-3 mb-4 justify-center font-bold">Bumble</button><button data-hk="s10-2" class="rounded-none inline-block px-5 py-3 mb-4 justify-center font-bold">Bold</button><button data-hk="s10-3" class="rounded-none inline-block px-5 py-3 mb-4 justify-center font-bold">Overcast</button><button data-hk="s10-4" class="rounded-none inline-block px-5 py-3 mb-4 justify-center font-bold">Midnight</button></div></div><!--astro:end--></astro-island> </body></html> 